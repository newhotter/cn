---
layout: post
title: Extended DEA-DA 模型以及其Lingo代码
categories:
- 模型
- 代码
tags:
- 模型
- Lingo
- 代码
- DEA
---

DEA（数据包络分析）是一个广泛被用来进行效率评价的模型。自从1978年由Charnes和Cooper首次提出以来，已经成为经济学以及运筹学中的重要模型。DEA模型的求解软件和代码网上有很多，很多人也比较了解。

DEA-DA模型是由Sueyoshi(1999)提出来的一个模型。这个模型的作用是：首先对观测值进行分类，接着可以判断新加进来的观测值归属于那个分类。这个模型被广泛应用。

然而，我们有时候会面临一个问题。那就是总会有一些观测值，我们通过DEA-DA方法没办法很好的辨别其分类。Lofti和Mansouri(2008)提出了一个基于模糊方法的Extended DEA-DA（Extended Data Envelopment Analysis/Discriminant Analysis）模型。这个方法通过两阶段来准确分类。第一个阶段进行一个分类，找出其中比较模棱两可的观测值，进入第二阶段，进行二次分类。

下面我们来简单介绍一下这个模型，具体模型参见(Hosseinzadeh Lotfi  and Bahareh Mansouri （2008）The Extended Data Envelopment Analysis/Discriminant Analysis Approach of Fuzzy Models)。

假定有n个样本，每个样本都有k个特征，Z_ij（i=1,…,k,j=1,...,n）表示第j个样本的第i个特征数据。这是一个初始的样本。先主观上将样本分成两个组G1,G2，分别有n1和n2各样本，n=n1+n2。（也可以随机分组，n1和n2的大小可以不一致，但最好不要相差太多）

第一个阶段的时候，通过一个优化目标，将观测值区分成三类（这三类跟以前的G1/G2没有任何关系）。其中有一类是没有办法通过第一阶段明确区分分类的观测值集合。第二阶段，对无法明确区分分类的观测值集合，再同构一个优化目标，将其区分。

这个模型的代码也分第一阶段和第二阶段。模型的代码使用Lingo编写。注意要看懂这个代码必须要看原论文。另外，三个分类需要自己在Excel里写公式区分。

Stage1.lg4

``` 
MODEL:
SETS:
DMU1/1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19/:S1,S2;  !G1,J有19种;
DMU2/1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19/:S3,S4;  !G2,J有19种;
FACTOR/1,2,3,4/:W; !指标的权重，I有四种;
DXF1( DMU1, FACTOR): F1; 
DXF2( DMU2, FACTOR): F2;
ENDSETS
DATA:
F1=4.32 	3.89 	-6.70 	-10.51 
5.00 	4.93 	-7.41 	-10.61 
5.49 	5.40 	-8.05 	-11.21 
5.26 	6.29 	-7.91 	-11.29 
6.26 	5.58 	-8.54 	-11.30 
7.01 	6.84 	-8.87 	-11.91 
4.87 	4.94 	-8.28 	-12.34 
7.63 	6.78 	-9.15 	-12.35 
7.20 	6.92 	-9.01 	-12.54 
6.85 	7.06 	-8.35 	-12.55 
7.56 	7.25 	-9.34 	-12.65 
7.54 	6.57 	-9.51 	-12.75 
8.30 	8.12 	-9.95 	-13.13 
7.59 	7.16 	-9.71 	-13.43 
8.37 	7.59 	-10.44 	-13.48 
7.68 	8.19 	-10.20 	-13.49 
8.00 	7.34 	-9.96 	-13.66 
7.66 	7.16 	-9.93 	-13.70 
6.61 	7.09 	-10.15 	-13.73; 
			
F2=7.44 	7.44 	-9.55 	-13.77 
8.51 	8.04 	-10.22 	-13.85 
9.42 	9.13 	-11.14 	-14.26 
9.06 	7.86 	-10.88 	-14.29 
7.60 	6.73 	-10.89 	-14.36 
8.83 	8.08 	-10.55 	-14.41 
9.42 	8.71 	-11.07 	-14.53 
9.20 	9.10 	-11.21 	-14.60 
9.42 	9.18 	-11.28 	-14.67 
8.72 	8.82 	-10.96 	-14.96 
10.19 	9.88 	-11.72 	-15.17 
9.38 	9.15 	-11.57 	-15.24 
10.35 	10.25 	-12.09 	-15.47 
10.44 	10.09 	-12.16 	-15.55 
9.10 	8.86 	-11.58 	-15.69 
10.07 	10.00 	-12.04 	-15.73 
10.14 	9.55 	-12.18 	-15.83 
10.69 	10.56 	-12.45 	-15.95 
10.72 	11.49 	-12.88 	-16.39;


ENDDATA

MIN =a+b;
@for(DMU1:
a=@SUM(DMU1:S1));!G1正松弛变量的和;
@for(DMU2:
b=@SUM(DMU2:S4));!G2负松弛变量的和;

@for(FACTOR:@FREE(W)); !去约束;
@FREE(d);	!去约束;

@for(DMU1(J):
1=@SUM(DXF1(J,I):W(I)* F1(J,I))+S1(J)-S2(J)-d);!对G1的约束;

@for(DMU2(J):
0=@SUM(DXF2(J,I):W(I)* F2(J,I))+S3(J)-S4(J)-d);!对G2的约束;


1=@SUM(FACTOR:@ABS(W));!权之和为1;
@for(DMU1(J):
S1(J)>=0);!非负约束;
@for(DMU1(J):
S2(J)>=0);
@for(DMU2(J):
S3(J)>=0);
@for(DMU2(J):
S4(J)>=0);
END

```

Stage2.lg4

``` 
MODEL:
SETS:
DMU1/1,2,3,4,5,6/:S1,S2;  !G1,J有6种;
DMU2/1,2,3,4,5,6/:S3,S4;  !G1,J有6种;
FACTOR/1,2,3,4,5,6/:W; !指标的权重，I有6种;
DXF1( DMU1, FACTOR): F1; 
DXF2( DMU2, FACTOR): F2;
DM1/1,2,3,4,5,6,7,8,9,10,11,12,13/:NU1;
DM2/1,2,3,4,5,6,7,8,9,10,11,12,13/:NU2;
CON1(DM1,FACTOR):F11;
CON2(DM2,FACTOR):F22;
ENDSETS

DATA:
!overlap;
F1=740	61155	580	2628	888	1198
4308	14766136	3360009	6347	946	1977
2059	3910685	1524343	4826	593	880
1913	4360006	318940	2867	882	1404
4022	8721707	2263593	10885	1331	3355
23590	91376298	8136824	27165	14883	22005;					
					
F2=1980	15093388	1191033	3177	1090	1288
8971	79719166	7545887	13874	5767	7018
1104	1778923	425644	1751	630	933
524	939178	121181	697	192	264
75	158475	0	84	22	49
148	132749	0	294	102	138;

F11=2004	11393446	507530	2857	708	835
193	385563	0	588	255	540
130	3113696	2103	254	85	140
242	475533	6173	387	179	221
6816	21216453	1338446	7344	3090	3221
4982	10968404	1280354	5421	2147	3105
2969	11337692	433773	3863	937	1538
948	15913130	61447	2634	965	1168
8614	40512571	5578100	11457	2220	2587
1886	7389407	1818049	3538	604	712
1335	3355674	523592	2603	687	1011
2112	13822520	866566	3278	1122	1282
1707	26469416	57766	1600	814	1710;

F22=26523	36061674	3168255	17124	10475	19558
12281	29316616	5675936	15427	4168	6086
9936	24108128	2778273	15369	4932	8941
6131	51915643	3578179	9022	3464	6753
12353	27219666	4471631	18318	5152	9656
34325	72693613	8871992	49305	14292	23994
31313	58947065	8280087	53037	17528	28145
25374	150840960	6453027	38237	9041	14106
11895	47561595	9880953	19140	5897	9461
43991	138605058	22512999	78154	25283	38601
45390	241635186	113450701	88960	50516	97994
12330	14898717	2009427	19507	5950	9236
2168	2221948	33378	17537	6742	3602;

ENDDATA


MIN =a+b;
@for(DMU1:
a=@SUM(DMU1:S1));!G1正松弛变量的和;
@for(DMU2:
b=@SUM(DMU2:S4));!G2负松弛变量的和;

@for(FACTOR:@FREE(W)); !去约束;
@BND(-146.8414,c,-145.8414);	!-146.8414 -145.8414;

@for(DM1(J):
-145.8414<=@SUM(CON1(J,I):W(I)* F11(J,I)));

@for(DM2(J):
-146.8414>=@SUM(CON2(J,I):W(I)* F22(J,I)));

@for(DMU1(J):
0=@SUM(DXF1(J,I):W(I)* F1(J,I))+S1(J)-S2(J)-c);!对G1的约束;

@for(DMU2(J):
0=@SUM(DXF2(J,I):W(I)* F2(J,I))+S3(J)-S4(J)-c);!对G2的约束;


1=@SUM(FACTOR:@ABS(W));!权之和为1;
@for(DMU1(J):
S1(J)>=0);!非负约束;
@for(DMU1(J):
S2(J)>=0);
@for(DMU2(J):
S3(J)>=0);
@for(DMU2(J):
S4(J)>=0);
END
```